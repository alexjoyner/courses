{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":";AAYA,MAAM,YAAY;IAAlB;QACS,UAAK,GAAgB,EAAE,CAAC;IA6BjC,CAAC;IA3BA,MAAM,CAAC,IAAW,EAAE,KAAa;QAChC,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IACnC,CAAC;IACD,SAAS,CAAC,IAAW,EAAE,CAAiB;QACvC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAC1B,CAAC;IACD,WAAW,CAAC,MAAsB,EAAE,OAA2B;QAC9D,MAAM,UAAU,GAAY,EAAE,CAAC;QAC/B,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAClC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;gBAC9C,IAAG,CAAC,IAAI,MAAM,EAAC;oBACd,OAAO,CAAC,IAAI,CAAC,CAAC;oBACd,OAAO,KAAK,CAAC;iBACb;gBACD,OAAO,IAAI,CAAC;YACb,CAAC,CAAC,CAAC;YACH,IAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAC;gBAChC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACtB;QACF,CAAC,CAAC,CAAA;QACF,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;IACjD,CAAC;IACD,eAAe,CAAC,IAAW,EAAE,KAAa;QACzC,IAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,SAAS;YAAE,OAAO;QAC1C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,QAAuB,EAAE,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;IACpE,CAAC;CACD;AAGD,MAAM,QAAQ,GAAG,CAAC,MAAmB,EAAE,IAAW,EAAE,IAAW,EAAE,MAAa,EAAE,EAAE,EAAE;IACnF,MAAM,SAAS,GAAkB,CAAC,GAAW,EAAE,EAAE;QAChD,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,aAAa,IAAI,QAAQ,GAAG,EAAE,CAAC,CAAC;QACnD,IAAG,GAAG,GAAG,GAAG,EAAC;YACZ,MAAM,CAAC,WAAW,CAAC,SAAS,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,iBAAiB,IAAI,EAAE,CAAC,CAAC,CAAA;SAChF;IACF,CAAC,CAAA;IACD,MAAM,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACnC,CAAC,CAAA;AAED,MAAM,QAAQ,GAAG,IAAI,YAAY,EAAE,CAAC;AACpC,QAAQ,CAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAG,EAAE,CAAC,CAAC;AAC1C,QAAQ,CAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAG,EAAE,CAAC,CAAC;AAC1C,QAAQ,CAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;AAC1C,QAAQ,CAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;AAC1C,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;AAC7B,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;AAC7B,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;AAC7B,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC","sourcesContent":["interface SocketObserverable {\r\n\tsubscribe(room:string, o: SocketObserver): void;\r\n\tunsubscribe(o: SocketObserver, success:(room:string)=>void): void;\r\n\tnotifyObservers(room:string, value: number): void;\r\n}\r\ninterface SocketObserver {\r\n\t(log: number): void;\r\n}\r\n\r\ninterface RoomsObject {\r\n\t[key:string]: SocketObserver[]\r\n}\r\nclass SocketSource implements SocketObserverable {\r\n\tprivate rooms: RoomsObject = {};\r\n\r\n\tnewLog(room:string, value: number) {\r\n\t\tthis.notifyObservers(room, value);\r\n\t}\r\n\tsubscribe(room:string, o: SocketObserver): void {\r\n\t\tthis.rooms[room] = this.rooms[room] || [];\r\n\t\tthis.rooms[room].push(o);\r\n\t}\r\n\tunsubscribe(target: SocketObserver, success:(room:string)=>void): void {\r\n\t\tconst emptyRooms:string[] = [];\r\n\t\tObject.keys(this.rooms).map(room => {\r\n\t\t\tthis.rooms[room] = this.rooms[room].filter(o => {\r\n\t\t\t\tif(o == target){\r\n\t\t\t\t\tsuccess(room);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\tif(this.rooms[room].length === 0){\r\n\t\t\t\temptyRooms.push(room);\r\n\t\t\t}\r\n\t\t})\r\n\t\temptyRooms.map(room => delete this.rooms[room]);\r\n\t}\r\n\tnotifyObservers(room:string, value: number): void {\r\n\t\tif(this.rooms[room] === undefined) return;\r\n\t\tthis.rooms[room].map((observer:SocketObserver) => observer(value));\r\n\t}\r\n}\r\n\r\n\r\nconst LiveData = (Socket:SocketSource, name:string, room:string, max:number = 10) => {\r\n\tconst handleLog:SocketObserver = (log: number) => {\r\n\t\tconsole.log(`${name} received ${room} log ${log}`);\r\n\t\tif(log > max){\r\n\t\t\tSocket.unsubscribe(handleLog, () => console.log(`${name} removed from ${room}`))\r\n\t\t}\r\n\t}\r\n\tSocket.subscribe(room, handleLog);\r\n}\r\n\r\nconst MySocket = new SocketSource();\r\nLiveData(MySocket, 'Test1', 'Room1',  60);\r\nLiveData(MySocket, 'TestX', 'Room1',  64);\r\nLiveData(MySocket, 'Test2', 'Room1', 150);\r\nLiveData(MySocket, 'Test3', 'Room3', 600);\r\nMySocket.newLog('Room1', 65);\r\nMySocket.newLog('Room1', 14);\r\nMySocket.newLog('Room1', 65);\r\nMySocket.newLog('Room1', 70);"]}